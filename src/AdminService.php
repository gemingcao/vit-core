<?php// +----------------------------------------------------------------------// | VitPHP// +----------------------------------------------------------------------// | 版权所有 2018~2021 藁城区创新网络电子商务中心 [ http://www.vitphp.cn ]// +----------------------------------------------------------------------// | VitPHP是一款免费开源软件,您可以访问http://www.vitphp.cn/以获得更多细节。// +----------------------------------------------------------------------namespace vitphp\admin;use think\facade\Db;use think\facade\Route;use think\Service;use vitphp\admin\command\NodeRefresh;use vitphp\admin\middleware\SeoFetch;class AdminService extends Service{    public function register()    {        $subDomain = request()->subDomain();        $routing = Db::table('vit_routing')->where('domain', $subDomain)->find();        // dump($routing);        // dump($_GET);        if ($routing) {            $s = parse_url($routing['url']);            $q = empty($s['query']) ? '' : $s['query'];            $p = empty($s['path']) ? '' : $s['path'];            $s = '';            if ($routing['directory']) {                $s = '/' . $routing['directory'];            }            if ($p) {                $s .= '/' . $p;            }            // dump($s);            $_GET['s'] = $s . ($_GET['s'] ?? '');            parse_str($q, $query_arr);            $_GET = array_merge($_GET, $query_arr);            // dump("参数：", $_GET);        }        // 注册命令        $this->commands([            NodeRefresh::class        ]);    }    public function boot()    {        $this->app->middleware->add(SeoFetch::class);    }}